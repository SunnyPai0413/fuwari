---
title: 记一次证书失效错误
published: 2024-12-18
tags:
  - OS
  - Software
category: Zheteng
draft: false
---

刚刚收到了来自GXDE OS Team的证书过期警告。

我还挺疑惑：我都配置了证书自动获取工作流和自动同步工作流了啊，为什么还会过期？  
我使用的是Certd自动获取证书、inotify监听默认证书存储路径，然后 `rsync -avh --delete <src> <dst>` ，按理来说不应该出现失效的问题啊  
随后我进入web console确认，Certd也没有问题，正常更新证书：  
![](https://assets.blog.edge.sunnypai.top/记一次证书失效错误01.png)既然正常更新，那么应该正常工作。随后又尝试重启caddy，依旧无效。  
忽然我意识到，这两者之间使用的是一共inotify脚本同步，那是不是这个脚本没有正确运行呢？

查看脚本对应的日志，发现了大量的错误，表示脚本无法启动：![](https://assets.blog.edge.sunnypai.top/记一次证书失效错误02.png)systemd默认的root权限依旧denied？带着好奇我查看了文件：

```
root@sunnypai-superserver:/ # ls -al /AppData/Certd/sync.sh
-rw-r--r-- 1 root root 354 九月   18 12:04 /AppData/Certd/sync.sh
```

赫然发现，没有x权限……

再回想当时测试时的操作：

```
# sudo bash sync.sh
```

好吧，教训+1